{"version":3,"file":"bundle.js","sources":["../src/lib-test/util.js","../src/lib/element.js","../src/lib/util.js","../../../../node_modules/@babel/runtime/helpers/esm/typeof.js","../src/lib/patch.js","../../../../node_modules/list-diff2/lib/diff.js","../../../../node_modules/list-diff2/index.js","../src/lib/diff.js","../src/index.js"],"sourcesContent":["var _ = exports\n\n_.type = function (obj) {\n  return Object.prototype.toString.call(obj).replace(/\\[object\\s|\\]/g, '')\n}\n\n_.isArray = function isArray (list) {\n  return _.type(list) === 'Array'\n}\n\n_.slice = function slice (arrayLike, index) {\n  return Array.prototype.slice.call(arrayLike, index)\n}\n\n_.truthy = function truthy (value) {\n  return !!value\n}\n\n_.isString = function isString (list) {\n  return _.type(list) === 'String'\n}\n\n_.each = function each (array, fn) {\n  for (var i = 0, len = array.length; i < len; i++) {\n    fn(array[i], i)\n  }\n}\n\n_.toArray = function toArray (listLike) {\n  if (!listLike) {\n    return []\n  }\n\n  var list = []\n\n  for (var i = 0, len = listLike.length; i < len; i++) {\n    list.push(listLike[i])\n  }\n\n  return list\n}\n\n_.setAttr = function setAttr (node, key, value) {\n  switch (key) {\n    case 'style':\n      node.style.cssText = value\n      break\n    case 'value':\n      var tagName = node.tagName || ''\n      tagName = tagName.toLowerCase()\n      if (\n        tagName === 'input' || tagName === 'textarea'\n      ) {\n        node.value = value\n      } else {\n        // if it is not a input or textarea, use `setAttribute` to set\n        node.setAttribute(key, value)\n      }\n      break\n    default:\n      node.setAttribute(key, value)\n      break\n  }\n}\n","import _ from '../lib-test/util'\n\nfunction Element (tagName, props = {}, children = []) {\n  if (!(this instanceof Element)) {\n    return new Element(tagName, props, children)\n  }\n\n  if (props instanceof Array) {\n    children = props\n    props = {}\n  }\n\n  // 标签名\n  this.tagName = tagName\n  // 属性对象\n  this.props = props\n  // 子节点\n  this.children = children\n  // key标志\n  const { key = void 666 } = this.props\n  this.key = key\n\n  // 子节点数量\n  let count = 0\n  this.children.forEach((child, index) => {\n    if (child instanceof Element) {\n      count += child.count\n    }\n    count++\n  })\n  this.count = count\n}\n\nElement.prototype.render = function () {\n  const el = document.createElement(this.tagName)\n  const props = this.props\n\n  for (const propName in props) {\n    const propValue = props[propName]\n    _.setAttr(el, propName, propValue)\n  }\n\n  this.children.forEach((child) => {\n    let childEl\n\n    if (child instanceof Element) {\n      childEl = child.render()\n    } else {\n      childEl = document.createTextNode(child)\n    }\n    el.appendChild(childEl)\n  })\n\n  return el\n}\n\nexport default Element\n","var _ = exports\n\n_.type = function (obj) {\n  return Object.prototype.toString.call(obj).replace(/\\[object\\s|\\]/g, '')\n}\n\n_.isArray = function isArray (list) {\n  return _.type(list) === 'Array'\n}\n\n_.slice = function slice (arrayLike, index) {\n  return Array.prototype.slice.call(arrayLike, index)\n}\n\n_.truthy = function truthy (value) {\n  return !!value\n}\n\n_.isString = function isString (list) {\n  return _.type(list) === 'String'\n}\n\n_.each = function each (array, fn) {\n  for (var i = 0, len = array.length; i < len; i++) {\n    fn(array[i], i)\n  }\n}\n\n_.toArray = function toArray (listLike) {\n  if (!listLike) {\n    return []\n  }\n\n  var list = []\n\n  for (var i = 0, len = listLike.length; i < len; i++) {\n    list.push(listLike[i])\n  }\n\n  return list\n}\n\n_.setAttr = function setAttr (node, key, value) {\n  switch (key) {\n    case 'style':\n      node.style.cssText = value\n      break\n    case 'value':\n      var tagName = node.tagName || ''\n      tagName = tagName.toLowerCase()\n      if (\n        tagName === 'input' || tagName === 'textarea'\n      ) {\n        node.value = value\n      } else {\n        // if it is not a input or textarea, use `setAttribute` to set\n        node.setAttribute(key, value)\n      }\n      break\n    default:\n      node.setAttribute(key, value)\n      break\n  }\n}\n","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}","var _ = require('./util')\n\nvar REPLACE = 0\nvar REORDER = 1\nvar PROPS = 2\nvar TEXT = 3\n\nfunction patch (node, patches) {\n  var walker = {index: 0}\n  dfsWalk(node, walker, patches)\n}\n\nfunction dfsWalk (node, walker, patches) {\n  var currentPatches = patches[walker.index]\n\n  var len = node.childNodes\n    ? node.childNodes.length\n    : 0\n  for (var i = 0; i < len; i++) {\n    var child = node.childNodes[i]\n    walker.index++\n    dfsWalk(child, walker, patches)\n  }\n\n  if (currentPatches) {\n    applyPatches(node, currentPatches)\n  }\n}\n\nfunction applyPatches (node, currentPatches) {\n  _.each(currentPatches, function (currentPatch) {\n    switch (currentPatch.type) {\n      // 替换 diff\n      case REPLACE:\n        var newNode = (typeof currentPatch.node === 'string')\n          ? document.createTextNode(currentPatch.node)\n          : currentPatch.node.render()\n        node.parentNode.replaceChild(newNode, node)\n        break\n      // 子节点重新排序 diff\n      case REORDER:\n        reorderChildren(node, currentPatch.moves)\n        break\n      // 属性 diff\n      case PROPS:\n        setProps(node, currentPatch.props)\n        break\n      // 文本节点 diff\n      case TEXT:\n        node.textContent = currentPatch.content\n        break\n      default:\n        throw new Error('Unknown patch type ' + currentPatch.type)\n    }\n  })\n}\n\nfunction setProps (node, props) {\n  for (var key in props) {\n    if (props[key] === void 666) {\n      node.removeAttribute(key)\n    } else {\n      var value = props[key]\n      _.setAttr(node, key, value)\n    }\n  }\n}\n\nfunction reorderChildren (node, moves) {\n  var staticNodeList = _.toArray(node.childNodes)\n  var maps = {}\n\n  _.each(staticNodeList, function (node) {\n    if (node.nodeType === 1) {\n      var key = node.getAttribute('key')\n      if (key) {\n        maps[key] = node\n      }\n    }\n  })\n\n  _.each(moves, function (move) {\n    var index = move.index\n    if (move.type === 0) { // remove item\n      if (staticNodeList[index] === node.childNodes[index]) { // maybe have been removed for inserting\n        node.removeChild(node.childNodes[index])\n      }\n      staticNodeList.splice(index, 1)\n    } else if (move.type === 1) { // insert item\n      var insertNode = maps[move.item.key]\n        ? maps[move.item.key].cloneNode(true) // reuse old item\n        : (typeof move.item === 'object')\n            ? move.item.render()\n            : document.createTextNode(move.item)\n      staticNodeList.splice(index, 0, insertNode)\n      node.insertBefore(insertNode, node.childNodes[index] || null)\n    }\n  })\n}\n\npatch.REPLACE = REPLACE\npatch.REORDER = REORDER\npatch.PROPS = PROPS\npatch.TEXT = TEXT\n\nmodule.exports = patch\n","/**\r\n * Diff two list in O(N).\r\n * @param {Array} oldList - Original List\r\n * @param {Array} newList - List After certain insertions, removes, or moves\r\n * @return {Object} - {moves: <Array>}\r\n *                  - moves is a list of actions that telling how to remove and insert\r\n */\r\nfunction diff (oldList, newList, key) {\r\n  var oldMap = makeKeyIndexAndFree(oldList, key)\r\n  var newMap = makeKeyIndexAndFree(newList, key)\r\n\r\n  var newFree = newMap.free\r\n\r\n  var oldKeyIndex = oldMap.keyIndex\r\n  var newKeyIndex = newMap.keyIndex\r\n\r\n  var moves = []\r\n\r\n  // a simulate list to manipulate\r\n  var children = []\r\n  var i = 0\r\n  var item\r\n  var itemKey\r\n  var freeIndex = 0\r\n\r\n  // fist pass to check item in old list: if it's removed or not\r\n  while (i < oldList.length) {\r\n    item = oldList[i]\r\n    itemKey = getItemKey(item, key)\r\n    if (itemKey) {\r\n      if (!newKeyIndex.hasOwnProperty(itemKey)) {\r\n        children.push(null)\r\n      } else {\r\n        var newItemIndex = newKeyIndex[itemKey]\r\n        children.push(newList[newItemIndex])\r\n      }\r\n    } else {\r\n      var freeItem = newFree[freeIndex++]\r\n      children.push(freeItem || null)\r\n    }\r\n    i++\r\n  }\r\n\r\n  var simulateList = children.slice(0)\r\n\r\n  // remove items no longer exist\r\n  i = 0\r\n  while (i < simulateList.length) {\r\n    if (simulateList[i] === null) {\r\n      remove(i)\r\n      removeSimulate(i)\r\n    } else {\r\n      i++\r\n    }\r\n  }\r\n\r\n  // i is cursor pointing to a item in new list\r\n  // j is cursor pointing to a item in simulateList\r\n  var j = i = 0\r\n  while (i < newList.length) {\r\n    item = newList[i]\r\n    itemKey = getItemKey(item, key)\r\n\r\n    var simulateItem = simulateList[j]\r\n    var simulateItemKey = getItemKey(simulateItem, key)\r\n\r\n    if (simulateItem) {\r\n      if (itemKey === simulateItemKey) {\r\n        j++\r\n      } else {\r\n        // new item, just inesrt it\r\n        if (!oldKeyIndex.hasOwnProperty(itemKey)) {\r\n          insert(i, item)\r\n        } else {\r\n          // if remove current simulateItem make item in right place\r\n          // then just remove it\r\n          var nextItemKey = getItemKey(simulateList[j + 1], key)\r\n          if (nextItemKey === itemKey) {\r\n            remove(i)\r\n            removeSimulate(j)\r\n            j++ // after removing, current j is right, just jump to next one\r\n          } else {\r\n            // else insert item\r\n            insert(i, item)\r\n          }\r\n        }\r\n      }\r\n    } else {\r\n      insert(i, item)\r\n    }\r\n\r\n    i++\r\n  }\r\n\r\n  function remove (index) {\r\n    var move = {index: index, type: 0}\r\n    moves.push(move)\r\n  }\r\n\r\n  function insert (index, item) {\r\n    var move = {index: index, item: item, type: 1}\r\n    moves.push(move)\r\n  }\r\n\r\n  function removeSimulate (index) {\r\n    simulateList.splice(index, 1)\r\n  }\r\n\r\n  return {\r\n    moves: moves,\r\n    children: children\r\n  }\r\n}\r\n\r\n/**\r\n * Convert list to key-item keyIndex object.\r\n * @param {Array} list\r\n * @param {String|Function} key\r\n */\r\nfunction makeKeyIndexAndFree (list, key) {\r\n  var keyIndex = {}\r\n  var free = []\r\n  for (var i = 0, len = list.length; i < len; i++) {\r\n    var item = list[i]\r\n    var itemKey = getItemKey(item, key)\r\n    if (itemKey) {\r\n      keyIndex[itemKey] = i\r\n    } else {\r\n      free.push(item)\r\n    }\r\n  }\r\n  return {\r\n    keyIndex: keyIndex,\r\n    free: free\r\n  }\r\n}\r\n\r\nfunction getItemKey (item, key) {\r\n  if (!item || !key) return void 666\r\n  return typeof key === 'string'\r\n    ? item[key]\r\n    : key(item)\r\n}\r\n\r\nexports.makeKeyIndexAndFree = makeKeyIndexAndFree // exports for test\r\nexports.diff = diff\r\n","module.exports = require('./lib/diff').diff\n","var _ = require('./util')\nvar patch = require('./patch')\nvar listDiff = require('list-diff2')\n\nfunction diff (oldTree, newTree) {\n  var index = 0\n  var patches = {}\n  dfsWalk(oldTree, newTree, index, patches)\n  return patches\n}\n\nfunction dfsWalk (oldNode, newNode, index, patches) {\n  var currentPatch = []\n\n  // Node is removed.\n  if (newNode === null) {\n    // Real DOM node will be removed when perform reordering, so has no needs to do anything in here\n  // TextNode content replacing\n  } else if (_.isString(oldNode) && _.isString(newNode)) {\n    if (newNode !== oldNode) {\n      currentPatch.push({ type: patch.TEXT, content: newNode })\n    }\n  // Nodes are the same, diff old node's props and children\n  } else if (\n      oldNode.tagName === newNode.tagName &&\n      oldNode.key === newNode.key\n    ) {\n    // Diff props\n    var propsPatches = diffProps(oldNode, newNode)\n    if (propsPatches) {\n      currentPatch.push({ type: patch.PROPS, props: propsPatches })\n    }\n    // Diff children. If the node has a `ignore` property, do not diff children\n    if (!isIgnoreChildren(newNode)) {\n      diffChildren(\n        oldNode.children,\n        newNode.children,\n        index,\n        patches,\n        currentPatch\n      )\n    }\n  // Nodes are not the same, replace the old node with new node\n  } else {\n    currentPatch.push({ type: patch.REPLACE, node: newNode })\n  }\n\n  if (currentPatch.length) {\n    patches[index] = currentPatch\n  }\n}\n\nfunction diffChildren (oldChildren, newChildren, index, patches, currentPatch) {\n  var diffs = listDiff(oldChildren, newChildren, 'key')\n  newChildren = diffs.children\n\n  if (diffs.moves.length) {\n    var reorderPatch = { type: patch.REORDER, moves: diffs.moves }\n    currentPatch.push(reorderPatch)\n  }\n\n  var leftNode = null\n  var currentNodeIndex = index\n  _.each(oldChildren, function (child, i) {\n    var newChild = newChildren[i]\n    currentNodeIndex = (leftNode && leftNode.count)\n      ? currentNodeIndex + leftNode.count + 1\n      : currentNodeIndex + 1\n    dfsWalk(child, newChild, currentNodeIndex, patches)\n    leftNode = child\n  })\n}\n\nfunction diffProps (oldNode, newNode) {\n  var count = 0\n  var oldProps = oldNode.props\n  var newProps = newNode.props\n\n  var key, value\n  var propsPatches = {}\n\n  // Find out different properties\n  for (key in oldProps) {\n    value = oldProps[key]\n    if (newProps[key] !== value) {\n      count++\n      propsPatches[key] = newProps[key]\n    }\n  }\n\n  // Find out new property\n  for (key in newProps) {\n    value = newProps[key]\n    if (!oldProps.hasOwnProperty(key)) {\n      count++\n      propsPatches[key] = newProps[key]\n    }\n  }\n\n  // If properties all are identical\n  if (count === 0) {\n    return null\n  }\n\n  return propsPatches\n}\n\nfunction isIgnoreChildren (node) {\n  return (node.props && node.props.hasOwnProperty('ignore'))\n}\n\nmodule.exports = diff\n","import Element from './lib/element'\nimport diff from './lib/diff'\nimport patch from './lib/patch'\n\nconst el = Element\n\nlet count = 0\n\n// function renderTree () {\n//     count++\n\n//     var items = []\n//     var color = (count % 2 === 0)\n//       ? 'blue'\n//       : 'red'\n\n//     for (var i = 0; i < count; i++) {\n//       items.push(el('li', ['Item #' + i]))\n//     }\n\n//     return el('div', {'id': 'container'}, [\n//       el('h1', {style: 'color: ' + color}, ['simple virtal dom']),\n//       el('p', ['the count is :' + count]),\n//       el('ul', items)\n//     ])\n//   }\n\nfunction renderTree () {\n  return el('div', {'id': 'container'}, [\n          el('h1', {style: 'color: red'}, ['simple virtal dom']),\n          el('p', ['the count is :' + Math.random()])\n        ])\n}\n\nlet tree = renderTree()\nconst root = tree.render()\ndocument.body.appendChild(root)\n\nsetTimeout(() => {\n  const newTree = renderTree()\n  const patches = diff(tree, newTree)\n  patch(root, patches)\n  tree = newTree\n}, 2000)\n"],"names":["_","exports","type","obj","Object","prototype","toString","call","replace","isArray","list","slice","arrayLike","index","Array","truthy","value","isString","each","array","fn","i","len","length","toArray","listLike","push","setAttr","node","key","style","cssText","tagName","toLowerCase","setAttribute","Element","props","children","count","forEach","child","render","el","document","createElement","propName","propValue","childEl","createTextNode","appendChild","_typeof","Symbol","iterator","constructor","require$$0","REPLACE","REORDER","PROPS","TEXT","patch","patches","walker","dfsWalk","currentPatches","childNodes","applyPatches","currentPatch","newNode","parentNode","replaceChild","reorderChildren","moves","setProps","textContent","content","Error","removeAttribute","staticNodeList","maps","nodeType","getAttribute","move","removeChild","splice","insertNode","item","cloneNode","insertBefore","patch_1","diff","oldList","newList","oldMap","makeKeyIndexAndFree","newMap","newFree","free","oldKeyIndex","keyIndex","newKeyIndex","itemKey","freeIndex","getItemKey","hasOwnProperty","newItemIndex","freeItem","simulateList","remove","removeSimulate","j","simulateItem","simulateItemKey","insert","nextItemKey","listDiff2","require$$1","listDiff","require$$2","oldTree","newTree","oldNode","propsPatches","diffProps","isIgnoreChildren","diffChildren","oldChildren","newChildren","diffs","reorderPatch","leftNode","currentNodeIndex","newChild","oldProps","newProps","diff_1","renderTree","Math","random","tree","root","body","setTimeout"],"mappings":"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"}